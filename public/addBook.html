<!DOCTYPE html>
<html>
	<head>
	<meta charset="UTF-8">
		<!-- jQuery -->
		<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
		<!-- Bootstrap -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<!-- Bootswatch -->
		<link rel="stylesheet" type="text/css" href="https://bootswatch.com/slate/bootstrap.min.css">
		<!-- Local Styles -->
		<link rel="stylesheet" href="assets/css/style.css" type="text/css" />
		<!-- Google Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Bangers" rel="stylesheet">

		<title>Add Book | Comics &amp; Graphic Novels</title>

	</head>
	<body>

	<div class = "jumbotron">
    <div class = "container">
      <h1>Published Works</h1>
      <h3>Add Book</h3>
    </div>
  </div>

	<div class="container">

  <!-- Add Book Form -->
  <form class="form-horizontal">

	  <div class="form-group">
	    <label for="title" class="col-sm-2 control-label">Title</label>
	    <div class="col-sm-10">
	      <input type="text" class="form-control" id="title" placeholder="Amazing Spider-Man and Wolverine">
	    </div>
	  </div>

	  <div class="form-group">
	    <label for="issue" class="col-sm-2 control-label">Issue Number</label>
	    <div class="col-sm-10">
	      <input type="text" class="form-control" id="issue" placeholder="24">
	    </div>
	  </div>

	  <div class="form-group">
	    <label for="publishDate" class="col-sm-2 control-label">Year of Publish</label>
	    <div class="col-sm-10">
	      <input type="text" class="form-control" id="publishDate" placeholder="2012">
	    </div>
	  </div>

	  <div class="form-group">
	    <label for="role" class="col-sm-2 control-label">Role</label>
	    <div class="col-sm-10">
	      <input type="text" class="form-control" id="role" placeholder="Cover Artist">
	    </div>
	  </div>

	  <div class="form-group">
	    <label for="publisher" class="col-sm-2 control-label">Publisher</label>
	    <div class="col-sm-10">
	      <input type="text" class="form-control" id="publisher" placeholder="Marvel">
	    </div>
	  </div>

	  <div class="form-group">
	    <label for="synopsis" class="col-sm-2 control-label">Synopsis</label>
	    <div class="col-sm-10">
	      <textarea rows=3 type="text" class="form-control" id="synopsis" placeholder="Another great event featuring your favorite web-slinger and Wolverine."></textarea> 
	    </div>
	  </div>

	  <div class="form-group">
	    <label for="img_url" class="col-sm-2 control-label">Image URL</label>
	    <div class="col-sm-10">
	      <input type="text" class="form-control" id="img_url">
	    </div>
	  </div>

	  <div class="form-group">
	    <label for="characters" class="col-sm-2 control-label">Characters</label>
	    <div class="col-sm-10">
	      <input type="text" class="form-control" id="characters" placeholder="Use commas: Spider-Man, Wolverine">
	    </div>
	  </div>

	  <div class="form-group">
	    <label for="teams" class="col-sm-2 control-label">Teams</label>
	    <div class="col-sm-10">
	      <input type="text" class="form-control" id="teams" placeholder="Use commas: Avengers, X-Men">
	    </div>
	  </div>

	  <div class="form-group">
	    <div class="col-sm-offset-2 col-sm-10">
	      <button type="submit" id="addBook" class="btn btn-default">Submit</button>
	    </div>
	  </div>
	</form>

</div>

<script type="text/javascript">
    
    $("#addBook").on("click", function(event) {
      event.preventDefault();

      var newBook = {
        title: $("#title").val().trim(),
        issue: $("#issue").val().trim(),
        publish_date: $("#publishDate").val().trim(),
        publisher: $("#publisher").val().trim(),
        synopsis: $("#synopsis").val().trim(),
        role: $("#role").val().trim(),
        img_url: $("#img_url").val().trim(),
        characters: $("#characters").val().trim(),
        teams: $("#teams").val().trim()
      };

      function replaceStr(str) {
  		return str
	      .replace(/&/g, "&amp;")
	      .replace(/</g, "&lt;")
	      .replace(/>/g, "&gt;")
	      .replace(/"/g, "&quot;")
	      .replace(/'/g, "&#039;");
			}

			newBook.synopsis = replaceStr(newBook.synopsis);
      
      $.post("/book", newBook)
      .done(function(data) {
        console.log(data);
        alert("Adding book...");
      });
    });
  </script>

		</body>
	</html>